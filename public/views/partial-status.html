<script type="text/ng-template" id="statusModalContent.html">
    <div class="modal-header">
        <button type="button" class="close" ng-click="vm.ok()"><i class="fa fa-window-close" aria-hidden="true"></i></button>
        <h3 class="modal-title" id="modal-title">Resumen Estado de Sensor</h3>
    </div>
    <div class="modal-body" id="modal-body">
        <uib-tabset active="active">
            <uib-tab index="0" select="vm.getSensorReport()">
                <uib-tab-heading>
                    <i class="fa fa-thermometer-full" aria-hidden="true"></i> Ultima Lectura
                </uib-tab-heading>
                <br>
                <span us-spinner spinner-key="sensorReportSpinner"></span>
                <div ng-class="{
                'panel-success': vm.sensorDetails.status === 'ok',
                'panel-info': vm.sensorDetails.status === 'unknown',
                'panel-warning': vm.sensorDetails.status === 'warning',
                'panel-danger': vm.sensorDetails.status === 'critical' }" class="panel">
                    <div class="panel-heading">
                        <h3 class="panel-title">Sensor {{vm.sensorDetails.sensor.name}}</h3>
                    </div>
                    <div class="panel-body text-center">
                        <h4 class="bg-info">
                            Estado Actual: {{vm.sensorDetails.status | uppercase}}
                        </h4>
                        <p class="lead bg-primary">
                            Ult. Valor Leido: {{vm.sensorDetails.data}} {{vm.sensorDetails.sensor.type.units}} ({{vm.sensorDetails.timestamp}})
                        </p>
                    </div>
                </div>
            </uib-tab>
            <uib-tab index="1">
                <uib-tab-heading>
                    <i class="fa fa-database" aria-hidden="true"></i> Datos
                </uib-tab-heading>
                <br>
                <div class="panel panel-default">
                    <!-- Default panel contents -->
                    <div class="panel-heading">Equipo {{vm.sensorDetails.imei}}</div>
                    <div class="panel-body">
                        <p>MODELO {{vm.sensorDetails.model}}</p>
                    </div>
                </div>

                <div class="panel panel-default">
                    <!-- Default panel contents -->
                    <div class="panel-heading">Parametros del sensor {{vm.sensorDetails.sensor.name}}</div>
                    <div class="panel-body">

                        <div class="panel panel-danger">
                            <!-- Default panel contents -->
                            <div class="panel-heading">RANGO CRITICO</div>
                            <div class="panel-body">

                                <!-- List group -->
                                <div class="well ">
                                    <ul class="list-group" ng-repeat="criticalParams in vm.sensorDetails.sensor.params.critical">
                                        <li class="list-group-item">
                                            <strong>Mayor que: </strong>{{criticalParams.greather_than}} - <strong>Menor que: </strong>{{criticalParams.less_than}}
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </div>

                        <div class="panel panel-warning">
                            <!-- Default panel contents -->
                            <div class="panel-heading">RANGO ADVERTENCIA</div>
                            <div class="panel-body">

                                <!-- List group -->
                                <div class="well ">
                                    <ul class="list-group" ng-repeat="warningParams in vm.sensorDetails.sensor.params.warning">
                                        <li class="list-group-item"><strong>Mayor que: </strong>{{warningParams.greather_than}} - <strong>Menor que: </strong>{{warningParams.less_than}}</li>
                                    </ul>
                                </div>

                            </div>
                        </div>

                        <div class="panel panel-success">
                            <!-- Default panel contents -->
                            <div class="panel-heading">RANGO NORMAL</div>
                            <div class="panel-body">

                                <!-- List group -->
                                <div class="well ">
                                    <ul class="list-group" ng-repeat="okParams in vm.sensorDetails.sensor.params.ok">
                                        <li class="list-group-item"><strong>Mayor que: </strong>{{okParams.greather_than}} - <strong>Menor que: </strong>{{okParams.less_than}}</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </uib-tab>
            <uib-tab index="2" select="vm.getSensorReport()">
                <uib-tab-heading>
                    <i class="fa fa-bar-chart" aria-hidden="true"></i> Grafico
                </uib-tab-heading>
                <br>
                <span us-spinner spinner-key="sensorReportSpinner"></span>
                <highchart id="chart1" config="vm.chartConfig" class="span10" ng-if="vm.selectedGraphTab === true"></highchart>
            </uib-tab>
        </uib-tabset>
    </div>
    <div class="modal-footer">
        <button class="btn btn-primary" type="button" ng-click="vm.ok()">Volver</button>
    </div>
</script>

<div class="container">

    <div class="page-header text-center">
        <h1><span class="fa fa-id-card-o"></span> Estado de Sensores</h1>
    </div>

    <div class="well text-center">
        <p>Esta pagina permite <span class="text-success">ver</span> el estado de los sensores en tiempo real.</p>
    </div>

    <fieldset>
        <legend>Filtrar por:</legend>

        <div class="row">
            <div class="col-md-6">
                <label class="col-sm-3 control-label">Grupo</label>
                <ui-select ng-model="vm.group.selected" theme="bootstrap" uis-open-close="vm.onOpenCloseSelectGroup(isOpen)">
                    <ui-select-match placeholder="Seleccione o busque un grupo en la lista...">{{$select.selected.name}}</ui-select-match>
                    <ui-select-choices repeat="group in vm.groups | filter: $select.search">
                        <div ng-bind-html="group.name | highlight: $select.search"></div>
                    </ui-select-choices>
                </ui-select>
            </div>

            <div class="col-md-6">
                <label class="col-sm-3 control-label">Estado</label>
                <ui-select ng-model="vm.status.selected" theme="bootstrap" uis-open-close="vm.onOpenCloseSelectStatus(isOpen)">
                    <ui-select-match placeholder="Seleccione o busque un estado en la lista...">{{$select.selected.name}}</ui-select-match>
                    <ui-select-choices repeat="status in vm.statuses | filter: $select.search">
                        <div ng-bind-html="status.name | highlight: $select.search"></div>
                    </ui-select-choices>
                </ui-select>
            </div>
        </div>
    </fieldset>

    <br>

    <div class="bs-example" data-example-id="thumbnails-with-custom-content">
        <div class="col-sm-6 col-md-3" ng-repeat="x in vm.sensorList">
            <div class="thumbnail" style="background-color: #c8c8c8; min-height: 250px" ng-click="vm.open($index)">
                <img style="border: 5px solid; height: 25%; width: 25%; display: block;" src="../assets/img/node.png" class="img-responsive img-circle"
                     ng-style="
                     x.status == 'critical' && {'border-color': '#f2dede'} ||
                     x.status == 'warning' && {'border-color': '#fcf8e3'} ||
                     x.status == 'ok' && {'border-color': '#dff0d8'} ||
                     x.status == 'unknown' && {'border-color': '#337ab7'}">

                <div class="caption">
                    <h4 class="text-center"
                        ng-class="{ 'bg-danger'   : x.status == 'critical',
                          'bg-warning' : x.status == 'warning',
                          'bg-success'    : x.status == 'ok',
                          'bg-primary'   : x.status == 'unknown' }">{{x.sensor.name}}</h4>
                    <dl>
                        <dt>Ult. Valor Leido</dt>
                        <dd>{{x.data}} {{x.sensor.type.units}}</dd>

                        <dt>Fecha</dt>
                        <dd>{{x.timestamp}}</dd>
                    </dl>
                </div>
            </div>
        </div>
    </div>
</div>
